# -*- coding: utf-8 -*-
"""
/***************************************************************************
 ExportSRODialog
                                 A QGIS plugin
 Permet d'exporter un SRO de la BDD
 Generated by Plugin Builder: http://g-sherman.github.io/Qgis-Plugin-Builder/
                             -------------------
        begin                : 2023-01-03
        git sha              : $Format:%H$
        copyright            : (C) 2023 by Romain Lagrange - PCE Services
        email                : romain.lagrange@pceservices.fr
 ***************************************************************************/

/***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/
"""

import os
import processing
from PyQt5.QtCore import *
from qgis.core import *
from qgis.utils import iface
import getpass
import datetime

from qgis.PyQt import uic
from qgis.PyQt import QtWidgets
from qgis.PyQt.QtWidgets import QMessageBox

# This loads your .ui file so that PyQt can populate your plugin with the elements from Qt Designer
FORM_CLASS, _ = uic.loadUiType(os.path.join(
    os.path.dirname(__file__), 'ExportSRO_dialog_base.ui'))


class ExportSRODialog(QtWidgets.QDialog, FORM_CLASS):
    def __init__(self, parent=None):
        """Constructor."""
        super(ExportSRODialog, self).__init__(parent)
        # Set up the user interface from Designer through FORM_CLASS.
        # After self.setupUi() you can access any designer object by doing
        # self.<objectname>, and you can use autoconnect slots - see
        # http://qt-project.org/doc/qt-4.8/designer-using-a-ui-file.html
        # #widgets-and-dialogs-with-auto-connect
        self.setupUi(self)
        self.label_4.setEnabled(False)
        self.dateEdit.setEnabled(False)
        def verifREC():
            if self.checkBox.isChecked():
                self.label_4.setEnabled(True)
                self.dateEdit.setEnabled(True)
            else:
                self.label_4.setEnabled(False)
                self.dateEdit.setEnabled(False)
        self.checkBox.stateChanged.connect(verifREC)
        
        
        
    def exporterSRO(self):
        verifsite = None
        verifboite = None
        verifcable = None
        verifadduction = None
        verifpt = None
        verifsupport = None
        verifimmeuble = None
        verifpavillon = None
        verifcomplement = None
        verifzacable = None
        verifzapbo = None
        verifzasro = None
        verifzanro = None
        datemco = None
        verifdbl = None
        dblcomplet = None

        dbllyr = None
        if self.checkBox.isChecked():
            datemco = self.dateEdit.date()
            datemco = datemco.toString('dd/MM/yyyy')
    
        for layer in QgsProject.instance().mapLayers().values():
            if 'site_exe' in layer.name():
                sitelyr = layer
                verifsite = 1
                
            if 'boite_optique_exe' in layer.name():
                boitelyr = layer
                boitelyr.removeSelection()
                verifboite = 1
            if 'cable_optique_exe' in layer.name():
                cablelyr = layer
                cablelyr.removeSelection()
                verifcable = 1
            if 'adduction_exe' in layer.name():
                adductionlyr = layer
                adductionlyr.removeSelection()
                verifadduction = 1
            if 'point_technique_exe' in layer.name():
                ptlyr = layer
                ptlyr.removeSelection()
                verifpt = 1
            if 'support_exe' in layer.name():
                supportlyr = layer
                supportlyr.removeSelection()
                verifsupport = 1
            if 'dbl_immeuble_exe' in layer.name():
                dblimmeublelyr = layer
                dblimmeublelyr.removeSelection()
                verifimmeuble = 1
            if 'dbl_pavillon_exe' in layer.name():
                dblpavillonlyr = layer
                dblpavillonlyr.removeSelection()
                verifpavillon = 1
            if 'dbl_complement_exe' in layer.name():
                dblcomplementlyr = layer
                dblcomplementlyr.removeSelection()
                verifcomplement = 1
            if 'dbl_exe' in layer.name():
                dbllyr = layer
                dbllyr.removeSelection()
                verifdbl = 1
            if 'zacable_exe' in layer.name():
                zacablelyr = layer
                zacablelyr.removeSelection()
                verifzacable = 1
            if 'zapbo_exe' in layer.name():
                zapbolyr = layer
                zapbolyr.removeSelection()
                verifzapbo = 1
            if 'zasro_exe' in layer.name():
                zasrolyr = layer
                zasrolyr.removeSelection()
                verifzasro = 1
            if 'zanro_exe' in layer.name():
                zanrolyr = layer
                zanrolyr.removeSelection()
                verifzanro = 1
        
        if verifsite == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche site est manquante')
        if verifboite == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche boite_optique est manquante')
        if verifcable == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche cable_optique est manquante')
        if verifadduction == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche adduction est manquante')
        if verifpt == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche point_technique est manquante')
        if verifsupport == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche support est manquante')

        if verifzacable == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche zacable est manquante')
        if verifzapbo == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche zapbo est manquante')
        if verifzasro == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche zasro est manquante')
        if verifzanro == None:
            QMessageBox.critical(None, "Couche manquante", 'La couche zanro est manquante')
        if verifsite != None and verifboite != None and verifcable != None and verifadduction != None and verifpt != None and verifsupport != None and verifzacable != None and verifzapbo != None and verifzasro != None and verifzanro != None and (verifdbl != None or (verifimmeuble != None and verifpavillon != None and verifcomplement != None)):
            if sitelyr.selectedFeatureCount()==1:
                for site in sitelyr.selectedFeatures():
                    nomsro = site["nom"][4:14]
                    print(nomsro)
                    nomnro = site["nom"][4:10]
                    departement = nomsro[0:2]

                    typeexport = site["type_fonct"]
                
                #BOITE_OPTIQUE

                if typeexport == "SOUS-REPARTITEUR OPTIQUE":
                    if datemco == None:
                        for boite in boitelyr.getFeatures():
                            if nomsro in boite["nom"]:
                                boitelyr.select(boite.id())

                                
                    else :
                        for boite in boitelyr.getFeatures():
                            if nomsro in boite["nom"] and str(boite["date_mco"]) == datemco:
                                boitelyr.select(boite.id())

                elif 'NOEUD RACCORDEMENT' in typeexport:

                    for boite in boitelyr.getFeatures():

                        if boite['fonction'] == 'BPE':

                            if nomnro in boite["nom"]:

                                boitelyr.select(boite.id())
                print(boitelyr.selectedFeatureCount())
        
                #CABLE_OPTIQUE

                if typeexport == "SOUS-REPARTITEUR OPTIQUE":
                    if datemco == None:
                        for cable in cablelyr.getFeatures():
                            if nomsro in cable["nom"]:
                                cablelyr.select(cable.id())
                    else:
                        for boite in boitelyr.selectedFeatures():
                            for cable in cablelyr.getFeatures():
                                if boite["nom"] in cable["origine"] or boite["nom"] in cable["extremite"]:
                                    cablelyr.select(cable.id())

                elif 'NOEUD RACCORDEMENT' in typeexport:

                    for cable in cablelyr.getFeatures():

                        if nomnro in cable["nom"] and 'CTR' in cable["nom"]:

                            cablelyr.select(cable.id())
                

                

                if 'NOEUD RACCORDEMENT' in typeexport:

                    for site in sitelyr.getFeatures():

                        if nomnro in site["code"]:



                            for cable in cablelyr.selectedFeatures():

                                if site.geometry().intersects(cable.geometry()):

                                    sitelyr.select(site.id())

                                    
                #ZASRO
                if typeexport == "SOUS-REPARTITEUR OPTIQUE":
                    for zasro in zasrolyr.getFeatures():
                        if nomsro in zasro["ref_sro"]:
                            zasrolyr.select(zasro.id())

                            

                if 'NOEUD RACCORDEMENT' in typeexport:
                    for zasro in zasrolyr.getFeatures():
                        for site in sitelyr.selectedFeatures():
                            if zasro["ref_sro"] in site["nom"]:
                                zasrolyr.select(zasro.id())
                        
                        
                #DBL ET ADDUCTION

                if typeexport == "SOUS-REPARTITEUR OPTIQUE":
                    if datemco == None:
                        if dbllyr == None :
                            parameters = { 'INPUT' : dblcomplementlyr,
                                'INTERSECT' : QgsProcessingFeatureSourceDefinition(zasrolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                                'METHOD' : 0,
                                'PREDICATE' : [6] }
                            processing.run('qgis:selectbylocation', parameters)
                            parameters = { 'INPUT' : dblimmeublelyr,
                                'INTERSECT' : QgsProcessingFeatureSourceDefinition(zasrolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                                'METHOD' : 0,
                                'PREDICATE' : [6] }
                            processing.run('qgis:selectbylocation', parameters)
                            parameters = { 'INPUT' : dblpavillonlyr,
                                'INTERSECT' : QgsProcessingFeatureSourceDefinition(zasrolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                                'METHOD' : 0,
                                'PREDICATE' : [6] }
                            processing.run('qgis:selectbylocation', parameters)
                            
                            
                            dblcomplet = processing.run("native:saveselectedfeatures", {'INPUT': dblpavillonlyr, 'OUTPUT': 'memory:'})['OUTPUT']
                            QgsProject.instance().addMapLayer(dblcomplet)
                            
                            if dblimmeublelyr.selectedFeatureCount() > 0:
                                iface.copySelectionToClipboard(dblimmeublelyr)
                                dblcomplet.startEditing()
                                iface.pasteFromClipboard(dblcomplet)
                            
                            if dblcomplementlyr.selectedFeatureCount() > 0:
                                iface.copySelectionToClipboard(dblcomplementlyr)
                                dblcomplet.startEditing()
                                iface.pasteFromClipboard(dblcomplet)
                            dblcomplet.commitChanges()

                            dbllyr = processing.run("native:saveselectedfeatures", {'INPUT': dblpavillonlyr, 'OUTPUT': 'memory:'})['OUTPUT']
                            QgsProject.instance().addMapLayer(dbllyr)

                            if dblimmeublelyr.selectedFeatureCount() > 0:
                                iface.copySelectionToClipboard(dblimmeublelyr)
                                dbllyr.startEditing()
                                iface.pasteFromClipboard(dbllyr)
                            dbllyr.commitChanges()
                                    
                            parameters = { 'INPUT' : adductionlyr,
                                'INTERSECT' : dblcomplet,
                                'METHOD' : 0,
                                'PREDICATE' : [0] }
                            processing.run('qgis:selectbylocation', parameters)
                        else :
                            parameters = { 'INPUT' : dbllyr,
                                'INTERSECT' : QgsProcessingFeatureSourceDefinition(zasrolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                                'METHOD' : 0,
                                'PREDICATE' : [6] }
                            processing.run('qgis:selectbylocation', parameters)
                            dbllyr = processing.run("native:saveselectedfeatures", {'INPUT': dbllyr, 'OUTPUT': 'memory:'})['OUTPUT']
                            QgsProject.instance().addMapLayer(dbllyr)
                            parameters = { 'INPUT' : adductionlyr,
                                'INTERSECT' : dbllyr,
                                'METHOD' : 0,
                                'PREDICATE' : [0] }
                            processing.run('qgis:selectbylocation', parameters)
                        
                    else :
                        parameters = { 'INPUT' : adductionlyr,
                            'INTERSECT' : QgsProcessingFeatureSourceDefinition(boitelyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                            'METHOD' : 0,
                            'PREDICATE' : [0] }
                        processing.run('qgis:selectbylocation', parameters)
                        
                        parameters = { 'INPUT' : dblcomplementlyr,
                            'INTERSECT' : QgsProcessingFeatureSourceDefinition(adductionlyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                            'METHOD' : 0,
                            'PREDICATE' : [6] }
                        processing.run('qgis:selectbylocation', parameters)
                        parameters = { 'INPUT' : dblimmeublelyr,
                            'INTERSECT' : QgsProcessingFeatureSourceDefinition(adductionlyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                            'METHOD' : 0,
                            'PREDICATE' : [6] }
                        processing.run('qgis:selectbylocation', parameters)
                        parameters = { 'INPUT' : dblpavillonlyr,
                            'INTERSECT' : QgsProcessingFeatureSourceDefinition(adductionlyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                            'METHOD' : 0,
                            'PREDICATE' : [6] }
                        processing.run('qgis:selectbylocation', parameters)
                        
                        
                        dblcomplet = processing.run("native:saveselectedfeatures", {'INPUT': dblpavillonlyr, 'OUTPUT': 'memory:'})['OUTPUT']
                        QgsProject.instance().addMapLayer(dblcomplet)
                        
                        if dblimmeublelyr.selectedFeatureCount() > 0:
                            iface.copySelectionToClipboard(dblimmeublelyr)
                            dblcomplet.startEditing()
                            iface.pasteFromClipboard(dblcomplet)
                        
                        if dblcomplementlyr.selectedFeatureCount() > 0:
                            iface.copySelectionToClipboard(dblcomplementlyr)
                            dblcomplet.startEditing()
                            iface.pasteFromClipboard(dblcomplet)
                        dblcomplet.commitChanges()

                        dbllyr = processing.run("native:saveselectedfeatures", {'INPUT': dblpavillonlyr, 'OUTPUT': 'memory:'})['OUTPUT']
                        QgsProject.instance().addMapLayer(dbllyr)

                        if dblimmeublelyr.selectedFeatureCount() > 0:
                            iface.copySelectionToClipboard(dblimmeublelyr)
                            dbllyr.startEditing()
                            iface.pasteFromClipboard(dbllyr)
                        dbllyr.commitChanges()
                        
                #POINT_TECHNIQUE
                parameters = { 'INPUT' : supportlyr,
                    'INTERSECT' : QgsProcessingFeatureSourceDefinition(cablelyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'METHOD' : 0,
                    'PREDICATE' : [6] }
                processing.run('qgis:selectbylocation', parameters)
                

                if typeexport == "SOUS-REPARTITEUR OPTIQUE":
                    parameters = { 'INPUT' : supportlyr,
                        'INTERSECT' : QgsProcessingFeatureSourceDefinition(adductionlyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                        'METHOD' : 1,
                        'PREDICATE' : [6] }
                    processing.run('qgis:selectbylocation', parameters)
                

                if typeexport == "SOUS-REPARTITEUR OPTIQUE":
                    if datemco == None:
                        for zapbo in zapbolyr.getFeatures():
                            if nomsro in zapbo["nom"]:
                                zapbolyr.select(zapbo.id())
                    else :
                        for boite in boitelyr.selectedFeatures():
                            for zapbo in zapbolyr.getFeatures():
                                if boite["nom"] == zapbo["nom"]:
                                    zapbolyr.select(zapbo.id())


                parameters = { 'INPUT' : ptlyr,
                    'INTERSECT' : QgsProcessingFeatureSourceDefinition(zapbolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'METHOD' : 0,
                    'PREDICATE' : [6] }
                processing.run('qgis:selectbylocation', parameters)

                parameters = { 'INPUT' : ptlyr,
                    'INTERSECT' : QgsProcessingFeatureSourceDefinition(adductionlyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'METHOD' : 1,
                    'PREDICATE' : [0] }
                processing.run('qgis:selectbylocation', parameters)
                

                parameters = { 'INPUT' : ptlyr,
                    'INTERSECT' : QgsProcessingFeatureSourceDefinition(cablelyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'METHOD' : 1,
                    'PREDICATE' : [0] }
                processing.run('qgis:selectbylocation', parameters)
                        
                parameters = { 'INPUT' : zacablelyr,
                    'INTERSECT' : QgsProcessingFeatureSourceDefinition(zapbolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'METHOD' : 0,
                    'PREDICATE' : [1] }
                processing.run('qgis:selectbylocation', parameters)
                
                if 'NOEUD RACCORDEMENT' in typeexport:

                    for zanro in zanrolyr.getFeatures():

                        if nomsro in zanro["ref_nro"]:

                                zanrolyr.select(zanro.id())

                else:
                    parameters = { 'INPUT' : zanrolyr,
                        'INTERSECT' : QgsProcessingFeatureSourceDefinition(zasrolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                        'METHOD' : 0,
                        'PREDICATE' : [0] }
                    processing.run('qgis:selectbylocation', parameters)

                username = getpass.getuser()
                now = datetime.datetime.now()
                now = now.strftime("%d-%m-%Y-%H-%M-%S")
                folder = "C:/Users/"+str(username)+"/Desktop/EXPORT-"+nomsro+"-"+now+"/"
                os.mkdir(folder)
                version = self.lineEdit.text()

                
                if departement == '21':
                    adductionrefac = [{'expression': '"ID"','length': 5,'name': 'ID','precision': 0,'type': 2},{'expression': '"TYPE_STRUC"','length': 45,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 4,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"LG"','length': 4,'name': 'LG','precision': 0,'type': 2},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    boiterefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 50,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"DIMENSION"','length': 254,'name': 'DIMENSION','precision': 0,'type': 10},{'expression': '"INTERCO"','length': 50,'name': 'INTERCO','precision': 0,'type': 10},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"NBEPISSURE"','length': 10,'name': 'NBEPISSURE','precision': 0,'type': 4},{'expression': '"NBABONNES"','length': 10,'name': 'NBABONNES','precision': 0,'type': 4},{'expression': '"FA_FS"','length': 10,'name': 'FA_FS','precision': 0,'type': 4},{'expression': '"NBFUTILE"','length': 10,'name': 'NBFUTILE','precision': 0,'type': 4},{'expression': '"SUPPORT"','length': 50,'name': 'SUPPORT','precision': 0,'type': 10},{'expression': '"FONCTION"','length': 10,'name': 'FONCTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"ID_PARENT"','length': 254,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"FTTH"','length': 10,'name': 'FTTH','precision': 0,'type': 4},{'expression': '"FTTE"','length': 10,'name': 'FTTE','precision': 0,'type': 4},{'expression': '"FAFSH"','length': 10,'name': 'FAFSH','precision': 0,'type': 4},{'expression': '"FAFSE"','length': 10,'name': 'FAFSE','precision': 0,'type': 4},{'expression': '"NBFUH"','length': 10,'name': 'NBFUH','precision': 0,'type': 4},{'expression': '"NBFUE"','length': 10,'name': 'NBFUE','precision': 0,'type': 4},{'expression': '"TYPE_EQUIP"','length': 200,'name': 'TYPE_EQUIP','precision': 0,'type': 10},{'expression': '"VOLUME"','length': 200,'name': 'VOLUME','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 200,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"HAUTEUR"','length': 200,'name': 'HAUTEUR','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 200,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    siterefac = [{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONCT"','length': 254,'name': 'TYPE_FONCT','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"TYPERACC"','length': 50,'name': 'TYPERACC','precision': 0,'type': 10},{'expression': '"HEXACLE"','length': 254,'name': 'HEXACLE','precision': 0,'type': 10},{'expression': '"NBPRISES"','length': 10,'name': 'NBPRISES','precision': 0,'type': 4},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"INSEE"','length': 5,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"ST_CODE"','length': 14,'name': 'ST_CODE','precision': 0,'type': 10},{'expression': '"DATE_POSE"','length': 10,'name': 'DATE_POSE','precision': 0,'type': 10}]
                    cablerefac = [{'expression': '"NOM"','length': 24,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 24,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 50,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 20,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 20,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 50,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 50,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"ETAT"','length': 38,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 20,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 20,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"LGR_REELLE"','length': 10,'name': 'LGR_REELLE','precision': 2,'type': 6},{'expression': '"LGR_CARTO"','length': 10,'name': 'LGR_CARTO','precision': 2,'type': 6},{'expression': '"DIAMETRE"','length': 10,'name': 'DIAMETRE','precision': 2,'type': 6},{'expression': '"TYPEFIBRE"','length': 50,'name': 'TYPEFIBRE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 20,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"CAPACITE"','length': 3,'name': 'CAPACITE','precision': 0,'type': 2},{'expression': '"ORIGINE"','length': 50,'name': 'ORIGINE','precision': 0,'type': 10},{'expression': '"EXTREMITE"','length': 50,'name': 'EXTREMITE','precision': 0,'type': 10},{'expression': '"SECTION"','length': 10,'name': 'SECTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"FUH"','length': 5,'name': 'FUH','precision': 0,'type': 2},{'expression': '"FUE"','length': 5,'name': 'FUE','precision': 0,'type': 2},{'expression': '"EL"','length': 5,'name': 'EL','precision': 0,'type': 2},{'expression': '"DATE_MCO"','length': 25,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    ptrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"LONGUEUR"','length': 10,'name': 'LONGUEUR','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 10,'name': 'LARGEUR','precision': 2,'type': 6},{'expression': '"PROF_HAUT"','length': 10,'name': 'PROF_HAUT','precision': 2,'type': 6},{'expression': '"SECTEUR"','length': 254,'name': 'SECTEUR','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"MODELE"','length': 254,'name': 'MODELE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"IDPARENT"','length': 15,'name': 'IDPARENT','precision': 0,'type': 10},{'expression': '"REMPLA_APP"','length': 3,'name': 'REMPLA_APP','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 20,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    supportrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"LG_REELLE"','length': 23,'name': 'LG_REELLE','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 23,'name': 'LARGEUR','precision': 0,'type': 6},{'expression': '"HAUTEUR"','length': 23,'name': 'HAUTEUR','precision': 0,'type': 6},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"AVAL"','length': 50,'name': 'AVAL','precision': 0,'type': 10},{'expression': '"INSEE"','length': 10,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"STRUCTURE"','length': 50,'name': 'STRUCTURE','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"COMPO"','length': 45,'name': 'COMPO','precision': 0,'type': 10},{'expression': '"DISPONIBLE"','length': 3,'name': 'DISPONIBLE','precision': 0,'type': 10},{'expression': '"UTILISATIO"','length': 2,'name': 'UTILISATIO','precision': 0,'type': 10},{'expression': '"CASSE_BLOC"','length': 3,'name': 'CASSE_BLOC','precision': 0,'type': 10},{'expression': '"REF_FICHE"','length': 50,'name': 'REF_FICHE','precision': 0,'type': 10},{'expression': '"MODE_POSE"','length': 2,'name': 'MODE_POSE','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 20,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    dblrefac = None
                    dblcomplementrefac = None
                    zapborefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 9,'name': 'NB_PRISES','precision': 0,'type': 2},{'expression': '"COMMENTAIR"','length': 50,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2}]
                    zacablerefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"COMMENTAIR"','length': 80,'name': 'COMMENTAIR','precision': 0,'type': 10}]
                    zasrorefac = [{'expression': '"REF_SRO"','length': 10,'name': 'REF_SRO','precision': 0,'type': 10},{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"EPCI"','length': 70,'name': 'EPCI','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                    zanrorefac = [{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]

                if departement == '31':
                    adductionrefac = [{'expression': '"TYPE_STRUC"','length': 10,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"LG"','length': 10,'name': 'LG','precision': 2,'type': 6},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ID"','length': 254,'name': 'ID','precision': 0,'type': 10}]
                    boiterefac = [{'expression': '"NOM"','length': 20,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 20,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 50,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 50,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 20,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 20,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 20,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 20,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"DIMENSION"','length': 254,'name': 'DIMENSION','precision': 0,'type': 10},{'expression': '"VOLUME"','length': 10,'name': 'VOLUME','precision': 2,'type': 6},{'expression': '"HAUTEUR"','length': 10,'name': 'HAUTEUR','precision': 2,'type': 6},{'expression': '"INTERCO"','length': 20,'name': 'INTERCO','precision': 0,'type': 10},{'expression': '"AMONT"','length': 20,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"NBEPISSURE"','length': 5,'name': 'NBEPISSURE','precision': 0,'type': 2},{'expression': '"NBABONNES"','length': 5,'name': 'NBABONNES','precision': 0,'type': 2},{'expression': '"FA_FS"','length': 5,'name': 'FA_FS','precision': 0,'type': 2},{'expression': '"NBFUTILE"','length': 5,'name': 'NBFUTILE','precision': 0,'type': 2},{'expression': '"SUPPORT"','length': 20,'name': 'SUPPORT','precision': 0,'type': 10},{'expression': '"FONCTION"','length': 10,'name': 'FONCTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"ID_PARENT"','length': 20,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"FTTH"','length': 10,'name': 'FTTH','precision': 0,'type': 4},{'expression': '"FTTE"','length': 10,'name': 'FTTE','precision': 0,'type': 4},{'expression': '"PB REDUIT"','length': 5,'name': 'PB REDUIT','precision': 2,'type': 6},{'expression': '"FAFSH"','length': 10,'name': 'FAFSH','precision': 0,'type': 4},{'expression': '"FAFSE"','length': 10,'name': 'FAFSE','precision': 0,'type': 4},{'expression': '"NBFUH"','length': 10,'name': 'NBFUH','precision': 0,'type': 4},{'expression': '"NBFUE"','length': 10,'name': 'NBFUE','precision': 0,'type': 4},{'expression': '"IB"','length': 10,'name': 'IB','precision': 0,'type': 4},{'expression': '"IH"','length': 10,'name': 'IH','precision': 0,'type': 4},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"xyboite"','length': 254,'name': 'xyboite','precision': 0,'type': 10},{'expression': '"TYPE_EQUIP"','length': 254,'name': 'TYPE_EQUIP','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 30,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"ETAT"','length': 38,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 10,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    siterefac = [{'expression': '"ID"','length': 10,'name': 'ID','precision': 0,'type': 4},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONCT"','length': 254,'name': 'TYPE_FONCT','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"TYPERACC"','length': 50,'name': 'TYPERACC','precision': 0,'type': 10},{'expression': '"HEXACLE"','length': 254,'name': 'HEXACLE','precision': 0,'type': 10},{'expression': '"NBPRISES"','length': 20,'name': 'NBPRISES','precision': 0,'type': 6},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"INSEE"','length': 5,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"ST_CODE"','length': 14,'name': 'ST_CODE','precision': 0,'type': 10},{'expression': '"DATE_POSE"','length': 10,'name': 'DATE_POSE','precision': 0,'type': 10},{'expression': '"NUM_ADR"','length': 23,'name': 'NUM_ADR','precision': 15,'type': 6},{'expression': '"LIB_COM"','length': 50,'name': 'LIB_COM','precision': 0,'type': 10},{'expression': '"C_POSTAL"','length': 23,'name': 'C_POSTAL','precision': 15,'type': 6},{'expression': '"AUM"','length': 23,'name': 'AUM','precision': 15,'type': 6},{'expression': '"VOIE_ADR"','length': 100,'name': 'VOIE_ADR','precision': 0,'type': 10}]
                    cablerefac = [{'expression': '"NOM"','length': 20,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 20,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 20,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 20,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 20,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 50,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 50,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 20,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 20,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"LGR_REELLE"','length': 10,'name': 'LGR_REELLE','precision': 2,'type': 6},{'expression': '"LGR_CARTO"','length': 10,'name': 'LGR_CARTO','precision': 2,'type': 6},{'expression': '"DIAMETRE"','length': 10,'name': 'DIAMETRE','precision': 2,'type': 6},{'expression': '"TYPEFIBRE"','length': 50,'name': 'TYPEFIBRE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 20,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"CAPACITE"','length': 3,'name': 'CAPACITE','precision': 0,'type': 2},{'expression': '"ORIGINE"','length': 50,'name': 'ORIGINE','precision': 0,'type': 10},{'expression': '"EXTREMITE"','length': 50,'name': 'EXTREMITE','precision': 0,'type': 10},{'expression': '"SECTION"','length': 10,'name': 'SECTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"FUH"','length': 5,'name': 'FUH','precision': 0,'type': 2},{'expression': '"FUE"','length': 5,'name': 'FUE','precision': 0,'type': 2},{'expression': '"EL"','length': 5,'name': 'EL','precision': 0,'type': 2},{'expression': '"TUH"','length': 5,'name': 'TUH','precision': 2,'type': 6},{'expression': '"TUE"','length': 5,'name': 'TUE','precision': 2,'type': 6},{'expression': '"DATE_MCO"','length': 10,'name': 'DATE_MCO','precision': 0,'type': 10},{'expression': '"x cable"','length': 254,'name': 'x cable','precision': 0,'type': 10},{'expression': '"ycable"','length': 254,'name': 'ycable','precision': 0,'type': 10},{'expression': '"SECTEUR"','length': 50,'name': 'SECTEUR','precision': 0,'type': 10},{'expression': '"ETAT"','length': 38,'name': 'ETAT','precision': 0,'type': 10}]
                    ptrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"LONGUEUR"','length': 10,'name': 'LONGUEUR','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 10,'name': 'LARGEUR','precision': 2,'type': 6},{'expression': '"PROF_HAUT"','length': 10,'name': 'PROF_HAUT','precision': 2,'type': 6},{'expression': '"SECTEUR"','length': 254,'name': 'SECTEUR','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"MODELE"','length': 254,'name': 'MODELE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"IDPARENT"','length': 15,'name': 'IDPARENT','precision': 0,'type': 10},{'expression': '"REMPLA_APP"','length': 3,'name': 'REMPLA_APP','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 10,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    supportrefac = [{'expression': '"id"','length': -1,'name': 'id','precision': 0,'type': 2},{'expression': '"nom"','length': 254,'name': 'nom','precision': 0,'type': 10},{'expression': '"code"','length': 254,'name': 'code','precision': 0,'type': 10},{'expression': '"proprietai"','length': 254,'name': 'proprietai','precision': 0,'type': 10},{'expression': '"gestionnai"','length': 254,'name': 'gestionnai','precision': 0,'type': 10},{'expression': '"type_struc"','length': 254,'name': 'type_struc','precision': 0,'type': 10},{'expression': '"lg_reelle"','length': -1,'name': 'lg_reelle','precision': 0,'type': 6},{'expression': '"largeur"','length': -1,'name': 'largeur','precision': 0,'type': 6},{'expression': '"hauteur"','length': -1,'name': 'hauteur','precision': 0,'type': 6},{'expression': '"amont"','length': 50,'name': 'amont','precision': 0,'type': 10},{'expression': '"aval"','length': 50,'name': 'aval','precision': 0,'type': 10},{'expression': '"insee"','length': 10,'name': 'insee','precision': 0,'type': 10},{'expression': '"comment"','length': 254,'name': 'comment','precision': 0,'type': 10},{'expression': '"structure"','length': 50,'name': 'structure','precision': 0,'type': 10},{'expression': '"isole"','length': -1,'name': 'isole','precision': 0,'type': 4},{'expression': '"compo"','length': 45,'name': 'compo','precision': 0,'type': 10},{'expression': '"disponible"','length': 3,'name': 'disponible','precision': 0,'type': 10},{'expression': '"utilisatio"','length': 2,'name': 'utilisatio','precision': 0,'type': 10},{'expression': '"casse_bloc"','length': 3,'name': 'casse_bloc','precision': 0,'type': 10},{'expression': '"ref_fiche"','length': 50,'name': 'ref_fiche','precision': 0,'type': 10},{'expression': '"mode_pose"','length': 2,'name': 'mode_pose','precision': 0,'type': 10},{'expression': '"date_mco"','length': 200,'name': 'date_mco','precision': 0,'type': 10},{'expression': '"avancement"','length': 250,'name': 'avancement','precision': 0,'type': 10},{'expression': '"equipe"','length': 250,'name': 'equipe','precision': 0,'type': 10},{'expression': '"commentair"','length': 250,'name': 'commentair','precision': 0,'type': 10},{'expression': '"code_nro"','length': -1,'name': 'code_nro','precision': 0,'type': 10},{'expression': '"code_sro"','length': -1,'name': 'code_sro','precision': 0,'type': 10},{'expression': '"zacable"','length': -1,'name': 'zacable','precision': 0,'type': 10}]
                    dblrefac = None
                    dblcomplementrefac = None
                    zapborefac = [{'expression': '"NOM"','length': 20,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"COMMENTAIR"','length': 254,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2}]
                    zacablerefac = [{'expression': '"NOM"','length': 20,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"COMMENTAIR"','length': 254,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"NB_FU"','length': 10,'name': 'NB_FU','precision': 0,'type': 4}]
                    zasrorefac = [{'expression': '"ID_1"','length': 10,'name': 'ID_1','precision': 0,'type': 4},{'expression': '"ID_0"','length': 10,'name': 'ID_0','precision': 0,'type': 4},{'expression': '"ID"','length': 10,'name': 'ID','precision': 0,'type': 4},{'expression': '"REF_SRO"','length': 10,'name': 'REF_SRO','precision': 0,'type': 10},{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 20,'name': 'NB_PRISE','precision': 0,'type': 6},{'expression': '"EPCI"','length': 70,'name': 'EPCI','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 10,'name': 'PLANNING','precision': 0,'type': 4},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"FTTE"','length': 10,'name': 'FTTE','precision': 0,'type': 4}]
                    zanrorefac = [{'expression': '"id"','length': 10,'name': 'id','precision': 0,'type': 4},{'expression': '"REF_NRO"','length': 50,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 50,'name': 'NB_PRISE','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 50,'name': 'PLANNING','precision': 0,'type': 10},{'expression': '"SST"','length': 50,'name': 'SST','precision': 0,'type': 10}]

                if departement == '39':
                    adductionrefac = [{'expression': '"ID"','length': 5,'name': 'ID','precision': 0,'type': 2},{'expression': '"TYPE_STRUC"','length': 45,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 4,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"LG"','length': 4,'name': 'LG','precision': 0,'type': 2},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    boiterefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 50,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"DIMENSION"','length': 254,'name': 'DIMENSION','precision': 0,'type': 10},{'expression': '"INTERCO"','length': 50,'name': 'INTERCO','precision': 0,'type': 10},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"NBEPISSURE"','length': 10,'name': 'NBEPISSURE','precision': 0,'type': 4},{'expression': '"NBABONNES"','length': 10,'name': 'NBABONNES','precision': 0,'type': 4},{'expression': '"FA_FS"','length': 10,'name': 'FA_FS','precision': 0,'type': 4},{'expression': '"NBFUTILE"','length': 10,'name': 'NBFUTILE','precision': 0,'type': 4},{'expression': '"SUPPORT"','length': 50,'name': 'SUPPORT','precision': 0,'type': 10},{'expression': '"FONCTION"','length': 10,'name': 'FONCTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"ID_PARENT"','length': 254,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"FTTH"','length': 10,'name': 'FTTH','precision': 0,'type': 4},{'expression': '"FTTE"','length': 10,'name': 'FTTE','precision': 0,'type': 4},{'expression': '"FAFSH"','length': 10,'name': 'FAFSH','precision': 0,'type': 4},{'expression': '"FAFSE"','length': 10,'name': 'FAFSE','precision': 0,'type': 4},{'expression': '"NBFUH"','length': 10,'name': 'NBFUH','precision': 0,'type': 4},{'expression': '"NBFUE"','length': 10,'name': 'NBFUE','precision': 0,'type': 4},{'expression': '"TYPE_EQUIP"','length': 200,'name': 'TYPE_EQUIP','precision': 0,'type': 10},{'expression': '"VOLUME"','length': 200,'name': 'VOLUME','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 200,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"HAUTEUR"','length': 200,'name': 'HAUTEUR','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 200,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    siterefac = [{'expression': '"id"','length': -1,'name': 'id','precision': 0,'type': 2},{'expression': '"code"','length': -1,'name': 'code','precision': 0,'type': 10},{'expression': '"nom"','length': -1,'name': 'nom','precision': 0,'type': 10},{'expression': '"proprietai"','length': -1,'name': 'proprietai','precision': 0,'type': 10},{'expression': '"gestionnai"','length': -1,'name': 'gestionnai','precision': 0,'type': 10},{'expression': '"type_fonct"','length': -1,'name': 'type_fonct','precision': 0,'type': 10},{'expression': '"etat"','length': -1,'name': 'etat','precision': 0,'type': 10},{'expression': '"type_struc"','length': -1,'name': 'type_struc','precision': 0,'type': 10},{'expression': '"emprise"','length': -1,'name': 'emprise','precision': 0,'type': 10},{'expression': '"typeracc"','length': -1,'name': 'typeracc','precision': 0,'type': 10},{'expression': '"hexacle"','length': -1,'name': 'hexacle','precision': 0,'type': 10},{'expression': '"nbprises"','length': -1,'name': 'nbprises','precision': 0,'type': 2},{'expression': '"comment"','length': -1,'name': 'comment','precision': 0,'type': 10},{'expression': '"rattach"','length': -1,'name': 'rattach','precision': 0,'type': 10},{'expression': '"insee"','length': 5,'name': 'insee','precision': 0,'type': 6},{'expression': '"st_code"','length': 14,'name': 'st_code','precision': 0,'type': 10},{'expression': '"date_pose"','length': 10,'name': 'date_pose','precision': 0,'type': 10},{'expression': '"avancement"','length': -1,'name': 'avancement','precision': 0,'type': 10},{'expression': '"racco_d"','length': -1,'name': 'racco_d','precision': 0,'type': 10},{'expression': '"racco_t"','length': -1,'name': 'racco_t','precision': 0,'type': 10},{'expression': '"racco_nro"','length': -1,'name': 'racco_nro','precision': 0,'type': 10},{'expression': '"code_nro"','length': 6,'name': 'code_nro','precision': 0,'type': 10},{'expression': '"code_sro"','length': 3,'name': 'code_sro','precision': 0,'type': 10}]
                    cablerefac = [{'expression': '"NOM"','length': 24,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 24,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 50,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 20,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 20,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 50,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 50,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"ETAT"','length': 38,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 20,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 20,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"LGR_REELLE"','length': 10,'name': 'LGR_REELLE','precision': 2,'type': 6},{'expression': '"LGR_CARTO"','length': 10,'name': 'LGR_CARTO','precision': 2,'type': 6},{'expression': '"DIAMETRE"','length': 10,'name': 'DIAMETRE','precision': 2,'type': 6},{'expression': '"TYPEFIBRE"','length': 50,'name': 'TYPEFIBRE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 20,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"CAPACITE"','length': 3,'name': 'CAPACITE','precision': 0,'type': 2},{'expression': '"ORIGINE"','length': 50,'name': 'ORIGINE','precision': 0,'type': 10},{'expression': '"EXTREMITE"','length': 50,'name': 'EXTREMITE','precision': 0,'type': 10},{'expression': '"SECTION"','length': 10,'name': 'SECTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"FUH"','length': 5,'name': 'FUH','precision': 0,'type': 2},{'expression': '"FUE"','length': 5,'name': 'FUE','precision': 0,'type': 2},{'expression': '"EL"','length': 5,'name': 'EL','precision': 0,'type': 2},{'expression': '"DATE_MCO"','length': 25,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    ptrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"LONGUEUR"','length': 10,'name': 'LONGUEUR','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 10,'name': 'LARGEUR','precision': 2,'type': 6},{'expression': '"PROF_HAUT"','length': 10,'name': 'PROF_HAUT','precision': 2,'type': 6},{'expression': '"SECTEUR"','length': 254,'name': 'SECTEUR','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"MODELE"','length': 254,'name': 'MODELE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"IDPARENT"','length': 15,'name': 'IDPARENT','precision': 0,'type': 10},{'expression': '"REMPLA_APP"','length': 3,'name': 'REMPLA_APP','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 20,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    supportrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"LG_REELLE"','length': 23,'name': 'LG_REELLE','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 23,'name': 'LARGEUR','precision': 0,'type': 6},{'expression': '"HAUTEUR"','length': 23,'name': 'HAUTEUR','precision': 0,'type': 6},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"AVAL"','length': 50,'name': 'AVAL','precision': 0,'type': 10},{'expression': '"INSEE"','length': 10,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"STRUCTURE"','length': 50,'name': 'STRUCTURE','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"COMPO"','length': 45,'name': 'COMPO','precision': 0,'type': 10},{'expression': '"DISPONIBLE"','length': 3,'name': 'DISPONIBLE','precision': 0,'type': 10},{'expression': '"UTILISATIO"','length': 2,'name': 'UTILISATIO','precision': 0,'type': 10},{'expression': '"CASSE_BLOC"','length': 3,'name': 'CASSE_BLOC','precision': 0,'type': 10},{'expression': '"REF_FICHE"','length': 50,'name': 'REF_FICHE','precision': 0,'type': 10},{'expression': '"MODE_POSE"','length': 2,'name': 'MODE_POSE','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 20,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    dblrefac = None
                    dblcomplementrefac = None
                    zapborefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 9,'name': 'NB_PRISES','precision': 0,'type': 2},{'expression': '"COMMENTAIR"','length': 50,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2}]
                    zacablerefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"COMMENTAIR"','length': 80,'name': 'COMMENTAIR','precision': 0,'type': 10}]
                    zasrorefac = [{'expression': '"REF_SRO"','length': 10,'name': 'REF_SRO','precision': 0,'type': 10},{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"EPCI"','length': 70,'name': 'EPCI','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                    zanrorefac = [{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                    
                if departement == '40':
                    adductionrefac = [{'expression': '"TYPE_STRUC"','length': 10,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 3,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"LG"','length': 10,'name': 'LG','precision': 2,'type': 6},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ID"','length': 30,'name': 'ID','precision': 0,'type': 10}]
                    boiterefac = [{'expression': '"NOM"','length': 20,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 20,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 28,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 50,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 20,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 20,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 20,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 20,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 20,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"DIMENSION"','length': 254,'name': 'DIMENSION','precision': 0,'type': 10},{'expression': '"VOLUME"','length': 10,'name': 'VOLUME','precision': 2,'type': 6},{'expression': '"HAUTEUR"','length': 10,'name': 'HAUTEUR','precision': 2,'type': 6},{'expression': '"INTERCO"','length': 50,'name': 'INTERCO','precision': 0,'type': 10},{'expression': '"AMONT"','length': 20,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"NBEPISSURE"','length': 5,'name': 'NBEPISSURE','precision': 0,'type': 2},{'expression': '"NBABONNES"','length': 5,'name': 'NBABONNES','precision': 0,'type': 2},{'expression': '"FA_FS"','length': 5,'name': 'FA_FS','precision': 0,'type': 2},{'expression': '"NBFUTILE"','length': 5,'name': 'NBFUTILE','precision': 0,'type': 2},{'expression': '"SUPPORT"','length': 20,'name': 'SUPPORT','precision': 0,'type': 10},{'expression': '"FONCTION"','length': 10,'name': 'FONCTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"ID_PARENT"','length': 20,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"FTTH"','length': 10,'name': 'FTTH','precision': 0,'type': 4},{'expression': '"FTTE"','length': 10,'name': 'FTTE','precision': 0,'type': 4},{'expression': '"PB REDUIT"','length': 5,'name': 'PB REDUIT','precision': 2,'type': 6},{'expression': '"FAFSH"','length': 10,'name': 'FAFSH','precision': 0,'type': 4},{'expression': '"FAFSE"','length': 10,'name': 'FAFSE','precision': 0,'type': 4},{'expression': '"NBFUH"','length': 10,'name': 'NBFUH','precision': 0,'type': 4},{'expression': '"NBFUE"','length': 10,'name': 'NBFUE','precision': 0,'type': 4},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"TYPE_EQUIP"','length': 100,'name': 'TYPE_EQUIP','precision': 0,'type': 10}]
                    siterefac = [{'expression': '"ID"','length': 20,'name': 'ID','precision': 0,'type': 6},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONCT"','length': 254,'name': 'TYPE_FONCT','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"TYPERACC"','length': 50,'name': 'TYPERACC','precision': 0,'type': 10},{'expression': '"HEXACLE"','length': 254,'name': 'HEXACLE','precision': 0,'type': 10},{'expression': '"NBPRISES"','length': 23,'name': 'NBPRISES','precision': 15,'type': 6},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"INSEE"','length': 5,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"ST_CODE"','length': 14,'name': 'ST_CODE','precision': 0,'type': 10},{'expression': '"DATE_POSE"','length': 10,'name': 'DATE_POSE','precision': 0,'type': 10}]
                    cablerefac = [{'expression': '"NOM"','length': 20,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 20,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 20,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 20,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 20,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 50,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 50,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"ETAT"','length': 50,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 20,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 25,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"LGR_REELLE"','length': 10,'name': 'LGR_REELLE','precision': 2,'type': 6},{'expression': '"LGR_CARTO"','length': 10,'name': 'LGR_CARTO','precision': 2,'type': 6},{'expression': '"DIAMETRE"','length': 10,'name': 'DIAMETRE','precision': 2,'type': 6},{'expression': '"TYPEFIBRE"','length': 50,'name': 'TYPEFIBRE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 20,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"CAPACITE"','length': 3,'name': 'CAPACITE','precision': 0,'type': 2},{'expression': '"ORIGINE"','length': 50,'name': 'ORIGINE','precision': 0,'type': 10},{'expression': '"EXTREMITE"','length': 50,'name': 'EXTREMITE','precision': 0,'type': 10},{'expression': '"SECTION"','length': 10,'name': 'SECTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"FUH"','length': 5,'name': 'FUH','precision': 0,'type': 2},{'expression': '"FUE"','length': 5,'name': 'FUE','precision': 0,'type': 2},{'expression': '"EL"','length': 5,'name': 'EL','precision': 0,'type': 2},{'expression': '"TUH"','length': 5,'name': 'TUH','precision': 0,'type': 2},{'expression': '"TUE"','length': 5,'name': 'TUE','precision': 0,'type': 2},{'expression': '"DATE_MCO"','length': 10,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    ptrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"LONGUEUR"','length': 10,'name': 'LONGUEUR','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 10,'name': 'LARGEUR','precision': 2,'type': 6},{'expression': '"PROF_HAUT"','length': 10,'name': 'PROF_HAUT','precision': 2,'type': 6},{'expression': '"SECTEUR"','length': 254,'name': 'SECTEUR','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"MODELE"','length': 254,'name': 'MODELE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"IDPARENT"','length': 15,'name': 'IDPARENT','precision': 0,'type': 10},{'expression': '"REMPLA_APP"','length': 3,'name': 'REMPLA_APP','precision': 0,'type': 10},{'expression': '"DOMAINE"','length': 254,'name': 'DOMAINE','precision': 0,'type': 10}]
                    supportrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"LG_REELLE"','length': 23,'name': 'LG_REELLE','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 23,'name': 'LARGEUR','precision': 0,'type': 6},{'expression': '"HAUTEUR"','length': 23,'name': 'HAUTEUR','precision': 0,'type': 6},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"AVAL"','length': 50,'name': 'AVAL','precision': 0,'type': 10},{'expression': '"INSEE"','length': 10,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"STRUCTURE"','length': 50,'name': 'STRUCTURE','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"COMPO"','length': 45,'name': 'COMPO','precision': 0,'type': 10},{'expression': '"DISPONIBLE"','length': 3,'name': 'DISPONIBLE','precision': 0,'type': 10},{'expression': '"UTILISATIO"','length': 2,'name': 'UTILISATIO','precision': 0,'type': 10},{'expression': '"CASSE_BLOC"','length': 3,'name': 'CASSE_BLOC','precision': 0,'type': 10},{'expression': '"REF_FICHE"','length': 50,'name': 'REF_FICHE','precision': 0,'type': 10},{'expression': '"MODE_POSE"','length': 2,'name': 'MODE_POSE','precision': 0,'type': 10}]
                    dblrefac = None
                    dblcomplementrefac = [{'expression': '"REF_IMB"','length': 15,'name': 'REF_IMB','precision': 0,'type': 10},{'expression': '"AD_CODE"','length': 14,'name': 'AD_CODE','precision': 0,'type': 10},{'expression': '"HEXACLE"','length': 14,'name': 'HEXACLE','precision': 0,'type': 10},{'expression': '"ID_BAN"','length': 24,'name': 'ID_BAN','precision': 0,'type': 10},{'expression': '"NUM_ADR"','length': 10,'name': 'NUM_ADR','precision': 0,'type': 4},{'expression': '"EX_NUM_ADR"','length': 1,'name': 'EX_NUM_ADR','precision': 0,'type': 10},{'expression': '"NOM_BAT"','length': 50,'name': 'NOM_BAT','precision': 0,'type': 10},{'expression': '"VOIE_ADR"','length': 254,'name': 'VOIE_ADR','precision': 0,'type': 10},{'expression': '"C_POSTAL"','length': 7,'name': 'C_POSTAL','precision': 0,'type': 10},{'expression': '"C_INSEE"','length': 7,'name': 'C_INSEE','precision': 0,'type': 10},{'expression': '"LIB_COM"','length': 254,'name': 'LIB_COM','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 10,'name': 'NB_PRISE','precision': 0,'type': 4},{'expression': '"X_L93_2154"','length': 30,'name': 'X_L93_2154','precision': 15,'type': 6},{'expression': '"Y_L93_2154"','length': 30,'name': 'Y_L93_2154','precision': 15,'type': 6},{'expression': '"REF_NRO"','length': 10,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"REF_SRO"','length': 14,'name': 'REF_SRO','precision': 0,'type': 10},{'expression': '"CRMAD_SRO"','length': 10,'name': 'CRMAD_SRO','precision': 0,'type': 10},{'expression': '"REF_PBO"','length': 18,'name': 'REF_PBO','precision': 0,'type': 10},{'expression': '"MDP_PBO"','length': 30,'name': 'MDP_PBO','precision': 0,'type': 10},{'expression': '"DDP_PBO"','length': 10,'name': 'DDP_PBO','precision': 0,'type': 10},{'expression': '"DPEXP_PBO"','length': 10,'name': 'DPEXP_PBO','precision': 0,'type': 10},{'expression': '"STATUT"','length': 30,'name': 'STATUT','precision': 0,'type': 10},{'expression': '"STATUT_OPE"','length': 30,'name': 'STATUT_OPE','precision': 0,'type': 10},{'expression': '"TYPE_ZONE"','length': 20,'name': 'TYPE_ZONE','precision': 0,'type': 10},{'expression': '"TECHNO"','length': 4,'name': 'TECHNO','precision': 0,'type': 10},{'expression': '"TYPE_BAT"','length': 30,'name': 'TYPE_BAT','precision': 0,'type': 10},{'expression': '"TYPE_CLI"','length': 6,'name': 'TYPE_CLI','precision': 0,'type': 10},{'expression': '"RACCO_BAT"','length': 20,'name': 'RACCO_BAT','precision': 0,'type': 10},{'expression': '"TRAV_BAT"','length': 30,'name': 'TRAV_BAT','precision': 0,'type': 10},{'expression': '"RAC_LONG"','length': 10,'name': 'RAC_LONG','precision': 0,'type': 4},{'expression': '"ACC_GEST"','length': 10,'name': 'ACC_GEST','precision': 0,'type': 4},{'expression': '"RAIS_GEST"','length': 50,'name': 'RAIS_GEST','precision': 0,'type': 10},{'expression': '"CONT_GEST"','length': 50,'name': 'CONT_GEST','precision': 0,'type': 10},{'expression': '"T_CON_GEST"','length': 14,'name': 'T_CON_GEST','precision': 0,'type': 10},{'expression': '"DATE_CONV"','length': 10,'name': 'DATE_CONV','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"VOIE_ADR_T"','length': 254,'name': 'VOIE_ADR_T','precision': 0,'type': 10},{'expression': '"PROJ_FUTUR"','length': 3,'name': 'PROJ_FUTUR','precision': 0,'type': 10},{'expression': '"DATE_PROJ"','length': 7,'name': 'DATE_PROJ','precision': 0,'type': 10}]
                    zapborefac = [{'expression': '"NOM"','length': 20,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"COMMENTAIR"','length': 254,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2}]
                    zacablerefac = [{'expression': '"NOM"','length': 20,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"COMMENTAIR"','length': 254,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"NB_FU"','length': 10,'name': 'NB_FU','precision': 0,'type': 4}]
                    zasrorefac = [{'expression': '"ID"','length': 20,'name': 'ID','precision': 0,'type': 6},{'expression': '"REF_SRO"','length': 14,'name': 'REF_SRO','precision': 0,'type': 10},{'expression': '"REF_NRO"','length': 10,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 20,'name': 'NB_PRISE','precision': 0,'type': 6},{'expression': '"EPCI"','length': 70,'name': 'EPCI','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 20,'name': 'PLANNING','precision': 0,'type': 6},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                    zanrorefac = [{'expression': '"ref_nro"','length': 10,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 23,'name': 'NB_PRISE','precision': 15,'type': 6},{'expression': '"PLANNING"','length': 23,'name': 'PLANNING','precision': 15,'type': 6},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                    
                if departement == '50':
                    adductionrefac = [{'expression': '"ID"','length': 5,'name': 'ID','precision': 0,'type': 2},{'expression': '"TYPE_STRUC"','length': 45,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"LG"','length': 10,'name': 'LG','precision': 0,'type': 4},{'expression': '"ATT_PTO"','length': 10,'name': 'ATT_PTO','precision': 2,'type': 6},{'expression': '"RAC_LONG"','length': 1,'name': 'RAC_LONG','precision': 0,'type': 2},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    boiterefac = [{'expression': '"CODE"','length': 50,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 50,'name': 'NOM','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"TYPE_EQUIP"','length': 254,'name': 'TYPE_EQUIP','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 50,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"DIMENSION"','length': 254,'name': 'DIMENSION','precision': 0,'type': 10},{'expression': '"HAUTEUR"','length': 10,'name': 'HAUTEUR','precision': 2,'type': 6},{'expression': '"INTERCO"','length': 50,'name': 'INTERCO','precision': 0,'type': 10},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"NBEPISSURE"','length': 5,'name': 'NBEPISSURE','precision': 0,'type': 2},{'expression': '"NBABONNES"','length': 5,'name': 'NBABONNES','precision': 0,'type': 2},{'expression': '"FA_FS"','length': 5,'name': 'FA_FS','precision': 0,'type': 2},{'expression': '"NBFUTILE"','length': 5,'name': 'NBFUTILE','precision': 0,'type': 2},{'expression': '"SUPPORT"','length': 50,'name': 'SUPPORT','precision': 0,'type': 10},{'expression': '"FONCTION"','length': 10,'name': 'FONCTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 10},{'expression': '"ATT_ENU"','length': 10,'name': 'ATT_ENU','precision': 2,'type': 6},{'expression': '"ATT_NUM"','length': 10,'name': 'ATT_NUM','precision': 2,'type': 6},{'expression': '"ATT_NUC"','length': 10,'name': 'ATT_NUC','precision': 2,'type': 6},{'expression': '"ATT_SRO"','length': 10,'name': 'ATT_SRO','precision': 2,'type': 6},{'expression': '"ATT_PBO"','length': 10,'name': 'ATT_PBO','precision': 2,'type': 6},{'expression': '"REF_IMB"','length': 15,'name': 'REF_IMB','precision': 0,'type': 10},{'expression': '"ID_PARENT"','length': 45,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 8,'name': 'DATE_MCO','precision': 0,'type': 10},{'expression': "format_date(date_pose,'yyyyMMdd')",'length': 10,'name': 'DATE_POSE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    siterefac = [{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONCT"','length': 254,'name': 'TYPE_FONCT','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"TYPERACC"','length': 50,'name': 'TYPERACC','precision': 0,'type': 10},{'expression': '"HEXACLE"','length': 10,'name': 'HEXACLE','precision': 0,'type': 10},{'expression': '"NBPRISES"','length': 10,'name': 'NBPRISES','precision': 0,'type': 4},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"INSEE"','length': 5,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"ST_CODE"','length': 10,'name': 'ST_CODE','precision': 0,'type': 10},{'expression': '"NOM_PGC"','length': 254,'name': 'NOM_PGC','precision': 0,'type': 10},{'expression': '"QLT_GEO"','length': 10,'name': 'QLT_GEO','precision': 0,'type': 10},{'expression': '"MODE_GEO"','length': 10,'name': 'MODE_GEO','precision': 0,'type': 10},{'expression': '"DATE_POSE"','length': 10,'name': 'DATE_POSE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    cablerefac = [{'expression': '"CODE"','length': 50,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 50,'name': 'NOM','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"TYPEFIBRE"','length': 50,'name': 'TYPEFIBRE','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"ORIGINE"','length': 50,'name': 'ORIGINE','precision': 0,'type': 10},{'expression': '"EXTREMITE"','length': 50,'name': 'EXTREMITE','precision': 0,'type': 10},{'expression': '"LGR_REELLE"','length': 10,'name': 'LGR_REELLE','precision': 2,'type': 6},{'expression': '"LGR_CARTO"','length': 10,'name': 'LGR_CARTO','precision': 2,'type': 6},{'expression': '"DIAMETRE"','length': 10,'name': 'DIAMETRE','precision': 0,'type': 4},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"CAPACITE"','length': 10,'name': 'CAPACITE','precision': 0,'type': 4},{'expression': '"SECTION"','length': 10,'name': 'SECTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 10},{'expression': '"MODULO"','length': 2,'name': 'MODULO','precision': 0,'type': 2},{'expression': '"NB_FUTILE"','length': 10,'name': 'NB_FUTILE','precision': 0,'type': 4},{'expression': '"ATT_LIN"','length': 10,'name': 'ATT_LIN','precision': 2,'type': 6},{'expression': '"ATT_TOT"','length': 10,'name': 'ATT_TOT','precision': 2,'type': 6},{'expression': '"DATE_MCO"','length': 8,'name': 'DATE_MCO','precision': 0,'type': 10},{'expression': "format_date(date_pose,'yyyyMMdd')",'length': 10,'name': 'DATE_POSE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    ptrefac = [{'expression': '"CODE"','length': 50,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 50,'name': 'NOM','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"APP_STRUCT"','length': 254,'name': 'APP_STRUCT','precision': 0,'type': 10},{'expression': '"MODELE"','length': 254,'name': 'MODELE','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"LONGUEUR"','length': 10,'name': 'LONGUEUR','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 10,'name': 'LARGEUR','precision': 2,'type': 6},{'expression': '"PROF_HAUT"','length': 10,'name': 'PROF_HAUT','precision': 2,'type': 6},{'expression': '"SECTEUR"','length': 254,'name': 'SECTEUR','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 10},{'expression': '"REMPLA_APP"','length': 3,'name': 'REMPLA_APP','precision': 0,'type': 10},{'expression': '"REF_PLA"','length': 254,'name': 'REF_PLA','precision': 0,'type': 10},{'expression': '"D3"','length': 1,'name': 'D3','precision': 0,'type': 10},{'expression': '"D3_NOK"','length': 3,'name': 'D3_NOK','precision': 0,'type': 10},{'expression': '"GESTVOI"','length': 254,'name': 'GESTVOI','precision': 0,'type': 10},{'expression': '"EFFORT"','length': 10,'name': 'EFFORT','precision': 2,'type': 6},{'expression': '"PLYNOX"','length': 1,'name': 'PLYNOX','precision': 0,'type': 10},{'expression': '"SECU"','length': 1,'name': 'SECU','precision': 0,'type': 10},{'expression': '"BD_VERT"','length': 1,'name': 'BD_VERT','precision': 0,'type': 10},{'expression': '"REF_EPLAN"','length': 254,'name': 'REF_EPLAN','precision': 0,'type': 10},{'expression': '"MODE_GEO"','length': 10,'name': 'MODE_GEO','precision': 0,'type': 10},{'expression': '"QLT_GEO"','length': 10,'name': 'QLT_GEO','precision': 0,'type': 10},{'expression': '"NUMERO"','length': 10,'name': 'NUMERO','precision': 0,'type': 4},{'expression': '"EX_NUM_ADR"','length': 50,'name': 'EX_NUM_ADR','precision': 0,'type': 10},{'expression': '"TYPE_VOIE"','length': 254,'name': 'TYPE_VOIE','precision': 0,'type': 10},{'expression': '"NOM_VOIE"','length': 254,'name': 'NOM_VOIE','precision': 0,'type': 10},{'expression': '"C_POSTAL"','length': 5,'name': 'C_POSTAL','precision': 0,'type': 10},{'expression': '"LIB_COM"','length': 254,'name': 'LIB_COM','precision': 0,'type': 10},{'expression': '"ID_PARENT"','length': 15,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 8,'name': 'DATE_MCO','precision': 0,'type': 10},{'expression': "format_date(date_pose,'yyyyMMdd')",'length': 10,'name': 'DATE_POSE','precision': 0,'type': 10},{'expression': '"DATE_ETU"','length': 8,'name': 'DATE_ETU','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    supportrefac = [{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"STRUCTURE"','length': 50,'name': 'STRUCTURE','precision': 0,'type': 10},{'expression': '"TYPE_GROUP"','length': 254,'name': 'TYPE_GROUP','precision': 0,'type': 10},{'expression': '"MODE_POSE"','length': 2,'name': 'MODE_POSE','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"LG_REELLE"','length': 10,'name': 'LG_REELLE','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 10,'name': 'LARGEUR','precision': 2,'type': 6},{'expression': '"HAUTEUR"','length': 10,'name': 'HAUTEUR','precision': 2,'type': 6},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"AVAL"','length': 50,'name': 'AVAL','precision': 0,'type': 10},{'expression': '"INSEE"','length': 5,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 10},{'expression': '"COMPO"','length': 45,'name': 'COMPO','precision': 0,'type': 10},{'expression': '"DISPONIBLE"','length': 3,'name': 'DISPONIBLE','precision': 0,'type': 10},{'expression': '"UTILISATIO"','length': 2,'name': 'UTILISATIO','precision': 0,'type': 10},{'expression': '"CASSE_BLOC"','length': 3,'name': 'CASSE_BLOC','precision': 0,'type': 10},{'expression': '"REF_FICHE"','length': 50,'name': 'REF_FICHE','precision': 0,'type': 10},{'expression': '"COULEUR"','length': 254,'name': 'COULEUR','precision': 0,'type': 10},{'expression': '"MODELE"','length': 254,'name': 'MODELE','precision': 0,'type': 10},{'expression': '"NB_CABLE"','length': 10,'name': 'NB_CABLE','precision': 0,'type': 4},{'expression': '"QLT_GEO"','length': 10,'name': 'QLT_GEO','precision': 0,'type': 10},{'expression': '"MODE_GEO"','length': 10,'name': 'MODE_GEO','precision': 0,'type': 10},{'expression': '"PLYNOX"','length': 1,'name': 'PLYNOX','precision': 0,'type': 10},{'expression': '"NOM_PGC"','length': 254,'name': 'NOM_PGC','precision': 0,'type': 10},{'expression': '"TYPE_REVET"','length': 254,'name': 'TYPE_REVET','precision': 0,'type': 10},{'expression': '"AIGUIL"','length': 1,'name': 'AIGUIL','precision': 0,'type': 10},{'expression': '"DATE_AIG"','length': 8,'name': 'DATE_AIG','precision': 0,'type': 10},{'expression': '"DATE_MAN"','length': 8,'name': 'DATE_MAN','precision': 0,'type': 10},{'expression': '"DATE_POSE"','length': 10,'name': 'DATE_POSE','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 20,'name': 'DATE_MCO','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    dblrefac = [{'expression': '"REF_IMB"','length': 15,'name': 'REF_IMB','precision': 0,'type': 10},{'expression': '"AD_CODE"','length': 14,'name': 'AD_CODE','precision': 0,'type': 10},{'expression': '"HEXACLE"','length': 14,'name': 'HEXACLE','precision': 0,'type': 10},{'expression': '"HEXSCOR"','length': 1,'name': 'HEXSCOR','precision': 0,'type': 10},{'expression': '"ID_BAN"','length': 24,'name': 'ID_BAN','precision': 0,'type': 10},{'expression': '"NUM_ADR"','length': 10,'name': 'NUM_ADR','precision': 0,'type': 4},{'expression': '"EX_NUM_ADR"','length': 1,'name': 'EX_NUM_ADR','precision': 0,'type': 10},{'expression': '"NOM_BAT"','length': 100,'name': 'NOM_BAT','precision': 0,'type': 10},{'expression': '"VOIE_ADR"','length': 254,'name': 'VOIE_ADR','precision': 0,'type': 10},{'expression': '"C_POSTAL"','length': 7,'name': 'C_POSTAL','precision': 0,'type': 10},{'expression': '"C_INSEE"','length': 7,'name': 'C_INSEE','precision': 0,'type': 10},{'expression': '"LIB_COM"','length': 254,'name': 'LIB_COM','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 10,'name': 'NB_PRISE','precision': 0,'type': 4},{'expression': "'NRO-'||code_nro",'length': -1,'name': 'REF_NRO','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'expression': '\'PMU-\'||code_nro||\'-\'||"code_sro"','length': -1,'name': 'REF_SRO','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'expression': '"REF_PBO"','length': 22,'name': 'REF_PBO','precision': 0,'type': 10},{'expression': '"MDP_PBO"','length': 30,'name': 'MDP_PBO','precision': 0,'type': 10},{'expression': '"DDP_PBO"','length': 10,'name': 'DDP_PBO','precision': 0,'type': 10},{'expression': '"DPEXP_PBO"','length': 10,'name': 'DPEXP_PBO','precision': 0,'type': 10},{'expression': '"STATUT"','length': 30,'name': 'STATUT','precision': 0,'type': 10},{'expression': '"TYPE_ZONE"','length': 20,'name': 'TYPE_ZONE','precision': 0,'type': 10},{'expression': '"TECHNO"','length': 4,'name': 'TECHNO','precision': 0,'type': 10},{'expression': '"TYPE_BAT"','length': 30,'name': 'TYPE_BAT','precision': 0,'type': 10},{'expression': '"TYPE_CLI"','length': 25,'name': 'TYPE_CLI','precision': 0,'type': 10},{'expression': '"RACCO_BAT"','length': 40,'name': 'RACCO_BAT','precision': 0,'type': 10},{'expression': '"RACCO_ENE"','length': 254,'name': 'RACCO_ENE','precision': 0,'type': 10},{'expression': '"TRAV_BAT"','length': 30,'name': 'TRAV_BAT','precision': 0,'type': 10},{'expression': '"RAC_LONG"','length': 10,'name': 'RAC_LONG','precision': 0,'type': 4},{'expression': '"PROPRIETAI"','length': 50,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"ACC_GEST"','length': 10,'name': 'ACC_GEST','precision': 0,'type': 4},{'expression': '"RAIS_GEST"','length': 50,'name': 'RAIS_GEST','precision': 0,'type': 10},{'expression': '"CONT_GEST"','length': 50,'name': 'CONT_GEST','precision': 0,'type': 10},{'expression': '"T_CON_GEST"','length': 14,'name': 'T_CON_GEST','precision': 0,'type': 10},{'expression': '"DATE_CONV"','length': 10,'name': 'DATE_CONV','precision': 0,'type': 10},{'expression': '"VOIE_ADR_T"','length': 254,'name': 'VOIE_ADR_T','precision': 0,'type': 10},{'expression': '"PROJ_FUTUR"','length': 3,'name': 'PROJ_FUTUR','precision': 0,'type': 10},{'expression': '"DATE_PROJ"','length': 7,'name': 'DATE_PROJ','precision': 0,'type': 10},{'expression': '"X_L93_2154"','length': 20,'name': 'X_L93_2154','precision': 2,'type': 6},{'expression': '"Y_L93_2154"','length': 20,'name': 'Y_L93_2154','precision': 2,'type': 6},{'expression': '"SUSCEP_RAD"','length': 10,'name': 'SUSCEP_RAD','precision': 0,'type': 10},{'expression': '"NB_PR_GP"','length': 10,'name': 'NB_PR_GP','precision': 0,'type': 4},{'expression': '"NB_PR_TPE"','length': 10,'name': 'NB_PR_TPE','precision': 0,'type': 4},{'expression': '"NB_PR_PRO"','length': 10,'name': 'NB_PR_PRO','precision': 0,'type': 4},{'expression': '"NB_PR_PUB"','length': 10,'name': 'NB_PR_PUB','precision': 0,'type': 4},{'expression': '"PUB_CAT"','length': 60,'name': 'PUB_CAT','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 8,'name': 'DATE_MCO','precision': 0,'type': 10},{'expression': '"ATT_PTO"','length': 10,'name': 'ATT_PTO','precision': 2,'type': 6},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    dblcomplementrefac = None
                    zapborefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 250,'name': 'COMMENT','precision': 0,'type': 10}]
                    zacablerefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"COMMENTAIR"','length': 80,'name': 'COMMENTAIR','precision': 0,'type': 10}]
                    zasrorefac = [{'expression': '"REF_SRO"','length': 10,'name': 'REF_SRO','precision': 0,'type': 10},{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"EPCI"','length': 70,'name': 'EPCI','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10},{'expression': '"I_SRO_NRO"','length': 10,'name': 'I_SRO_NRO','precision': 2,'type': 6},{'expression': '"PRIORITE"','length': 10,'name': 'PRIORITE','precision': 0,'type': 4}]
                    zanrorefac = [{'expression': '\'NRO-\'||"ref_nro"','length': 10,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                
                if departement == '82':
                    adductionrefac = [{'expression': '"TYPE_STRUC"','length': 45,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 6,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"LG"','length': 6,'name': 'LG','precision': 0,'type': 2},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ID"','length': 254,'name': 'ID','precision': 0,'type': 10}]
                    boiterefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 50,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"DIMENSION"','length': 254,'name': 'DIMENSION','precision': 0,'type': 10},{'expression': '"INTERCO"','length': 50,'name': 'INTERCO','precision': 0,'type': 10},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"NBEPISSURE"','length': 5,'name': 'NBEPISSURE','precision': 0,'type': 2},{'expression': '"NBABONNES"','length': 5,'name': 'NBABONNES','precision': 0,'type': 2},{'expression': '"FA_FS"','length': 10,'name': 'FA_FS','precision': 0,'type': 4},{'expression': '"NBFUTILE"','length': 5,'name': 'NBFUTILE','precision': 0,'type': 2},{'expression': '"SUPPORT"','length': 50,'name': 'SUPPORT','precision': 0,'type': 10},{'expression': '"FONCTION"','length': 10,'name': 'FONCTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"ID_PARENT"','length': 254,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"FTTH"','length': 10,'name': 'FTTH','precision': 0,'type': 4},{'expression': '"FTTE"','length': 10,'name': 'FTTE','precision': 0,'type': 4},{'expression': '"FAFSH"','length': 5,'name': 'FAFSH','precision': 0,'type': 2},{'expression': '"FAFSE"','length': 5,'name': 'FAFSE','precision': 0,'type': 2},{'expression': '"NBFUH"','length': 5,'name': 'NBFUH','precision': 0,'type': 2},{'expression': '"NBFUE"','length': 5,'name': 'NBFUE','precision': 0,'type': 2},{'expression': '"TYPE_EQUIP"','length': 200,'name': 'TYPE_EQUIP','precision': 0,'type': 10},{'expression': '"VOLUME"','length': 200,'name': 'VOLUME','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 200,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"HAUTEUR"','length': 200,'name': 'HAUTEUR','precision': 0,'type': 10},{'expression': '"XY"','length': 200,'name': 'XY','precision': 0,'type': 10},{'expression': '"PBREDUIT"','length': 1,'name': 'PBREDUIT','precision': 0,'type': 2},{'expression': '"DATE_MCO"','length': 80,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    siterefac = [{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONCT"','length': 254,'name': 'TYPE_FONCT','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"TYPERACC"','length': 50,'name': 'TYPERACC','precision': 0,'type': 10},{'expression': '"HEXACLE"','length': 254,'name': 'HEXACLE','precision': 0,'type': 10},{'expression': '"NBPRISES"','length': 10,'name': 'NBPRISES','precision': 0,'type': 4},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"INSEE"','length': 5,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"ST_CODE"','length': 14,'name': 'ST_CODE','precision': 0,'type': 10},{'expression': '"DATE_POSE"','length': 10,'name': 'DATE_POSE','precision': 0,'type': 10}]
                    cablerefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"LGR_REELLE"','length': 23,'name': 'LGR_REELLE','precision': 2,'type': 6},{'expression': '"LGR_CARTO"','length': 23,'name': 'LGR_CARTO','precision': 2,'type': 6},{'expression': '"DIAMETRE"','length': 23,'name': 'DIAMETRE','precision': 2,'type': 6},{'expression': '"TYPEFIBRE"','length': 50,'name': 'TYPEFIBRE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"CAPACITE"','length': 23,'name': 'CAPACITE','precision': 0,'type': 6},{'expression': '"ORIGINE"','length': 50,'name': 'ORIGINE','precision': 0,'type': 10},{'expression': '"EXTREMITE"','length': 50,'name': 'EXTREMITE','precision': 0,'type': 10},{'expression': '"SECTION"','length': 10,'name': 'SECTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 10},{'expression': '"FUH"','length': 5,'name': 'FUH','precision': 0,'type': 2},{'expression': '"TUH"','length': 5,'name': 'TUH','precision': 0,'type': 2},{'expression': '"FUE"','length': 5,'name': 'FUE','precision': 0,'type': 2},{'expression': '"TUE"','length': 5,'name': 'TUE','precision': 0,'type': 2},{'expression': '"EL"','length': 5,'name': 'EL','precision': 0,'type': 2},{'expression': '"TUH2"','length': 20,'name': 'TUH2','precision': 2,'type': 6},{'expression': '"TUE2"','length': 20,'name': 'TUE2','precision': 2,'type': 6},{'expression': '"DATE_MCO"','length': 10,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    ptrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"LONGUEUR"','length': 12,'name': 'LONGUEUR','precision': 11,'type': 6},{'expression': '"LARGEUR"','length': 12,'name': 'LARGEUR','precision': 11,'type': 6},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"MODELE"','length': 254,'name': 'MODELE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"REMPLA_APP"','length': 3,'name': 'REMPLA_APP','precision': 0,'type': 10},{'expression': '"ID_PARENT"','length': 15,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"PROF_HAUT"','length': 200,'name': 'PROF_HAUT','precision': 0,'type': 10},{'expression': '"XY"','length': 200,'name': 'XY','precision': 0,'type': 10},{'expression': '"SECTEUR"','length': 3,'name': 'SECTEUR','precision': 0,'type': 2},{'expression': '"IDPARENT"','length': 99,'name': 'IDPARENT','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 10,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    supportrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"LG_REELLE"','length': 23,'name': 'LG_REELLE','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 23,'name': 'LARGEUR','precision': 0,'type': 6},{'expression': '"HAUTEUR"','length': 23,'name': 'HAUTEUR','precision': 0,'type': 6},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"AVAL"','length': 50,'name': 'AVAL','precision': 0,'type': 10},{'expression': '"INSEE"','length': 10,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"STRUCTURE"','length': 50,'name': 'STRUCTURE','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"COMPO"','length': 45,'name': 'COMPO','precision': 0,'type': 10},{'expression': '"DISPONIBLE"','length': 3,'name': 'DISPONIBLE','precision': 0,'type': 10},{'expression': '"UTILISATIO"','length': 2,'name': 'UTILISATIO','precision': 0,'type': 10},{'expression': '"CASSE_BLOC"','length': 3,'name': 'CASSE_BLOC','precision': 0,'type': 10},{'expression': '"REF_FICHE"','length': 50,'name': 'REF_FICHE','precision': 0,'type': 10},{'expression': '"MODE_POSE"','length': 2,'name': 'MODE_POSE','precision': 0,'type': 10},{'expression': '"ETAT"','length': 38,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 10,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    dblrefac = None
                    dblcomplementrefac = None
                    zapborefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 9,'name': 'NB_PRISES','precision': 0,'type': 2},{'expression': '"COMMENTAIR"','length': 50,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2}]
                    zacablerefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 20,'name': 'NB_PRISES','precision': 0,'type': 6},{'expression': '"COMMENTAIR"','length': 80,'name': 'COMMENTAIR','precision': 0,'type': 10}]
                    zasrorefac = [{'expression': '"REF_SRO"','length': 10,'name': 'REF_SRO','precision': 0,'type': 10},{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"EPCI"','length': 70,'name': 'EPCI','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10},{'expression': '"ftth"','length': 3,'name': 'ftth','precision': 0,'type': 2},{'expression': '"ftte"','length': 3,'name': 'ftte','precision': 0,'type': 2}]
                    zanrorefac = [{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                    
                if departement == '85':
                    adductionrefac = [{'expression': '"TYPE_STRUC"','length': 45,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 4,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"LG"','length': 4,'name': 'LG','precision': 0,'type': 2},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ID"','length': 10,'name': 'ID','precision': 0,'type': 4},{'expression': '"ETAT"','length': 100,'name': 'ETAT','precision': 0,'type': 10}]
                    boiterefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 50,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"DIMENSION"','length': 254,'name': 'DIMENSION','precision': 0,'type': 10},{'expression': '"TYPE_EQUIP"','length': 254,'name': 'TYPE_EQUIP','precision': 0,'type': 10},{'expression': '"INTERCO"','length': 50,'name': 'INTERCO','precision': 0,'type': 10},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"VOLUME"','length': 23,'name': 'VOLUME','precision': 2,'type': 6},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"HAUTEUR"','length': 23,'name': 'HAUTEUR','precision': 2,'type': 6},{'expression': '"NBEPISSURE"','length': 5,'name': 'NBEPISSURE','precision': 0,'type': 2},{'expression': '"NBABONNES"','length': 5,'name': 'NBABONNES','precision': 0,'type': 2},{'expression': '"FA_FS"','length': 10,'name': 'FA_FS','precision': 0,'type': 4},{'expression': '"NBFUTILE"','length': 5,'name': 'NBFUTILE','precision': 0,'type': 2},{'expression': '"SUPPORT"','length': 50,'name': 'SUPPORT','precision': 0,'type': 10},{'expression': '"FONCTION"','length': 10,'name': 'FONCTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"ID_PARENT"','length': 45,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"IMB_DE_REF"','length': 20,'name': 'IMB_DE_REF','precision': 0,'type': 10}]
                    siterefac = [{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONCT"','length': 254,'name': 'TYPE_FONCT','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"TYPERACC"','length': 50,'name': 'TYPERACC','precision': 0,'type': 10},{'expression': '"HEXACLE"','length': 254,'name': 'HEXACLE','precision': 0,'type': 10},{'expression': '"NBPRISES"','length': 10,'name': 'NBPRISES','precision': 0,'type': 4},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"INSEE"','length': 5,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"ST_CODE"','length': 14,'name': 'ST_CODE','precision': 0,'type': 10},{'expression': '"DATE_POSE"','length': 10,'name': 'DATE_POSE','precision': 0,'type': 10}]
                    cablerefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"LGR_REELLE"','length': 23,'name': 'LGR_REELLE','precision': 2,'type': 6},{'expression': '"LGR_CARTO"','length': 23,'name': 'LGR_CARTO','precision': 2,'type': 6},{'expression': '"DIAMETRE"','length': 23,'name': 'DIAMETRE','precision': 2,'type': 6},{'expression': '"TYPEFIBRE"','length': 50,'name': 'TYPEFIBRE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"CAPACITE"','length': 23,'name': 'CAPACITE','precision': 0,'type': 6},{'expression': '"ORIGINE"','length': 50,'name': 'ORIGINE','precision': 0,'type': 10},{'expression': '"EXTREMITE"','length': 50,'name': 'EXTREMITE','precision': 0,'type': 10},{'expression': '"SECTION"','length': 10,'name': 'SECTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 10},{'expression': '"FU"','length': 9,'name': 'FU','precision': 0,'type': 2},{'expression': '"TU"','length': 9,'name': 'TU','precision': 2,'type': 6},{'expression': '"EL"','length': 10,'name': 'EL','precision': 0,'type': 4}]
                    ptrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"LONGUEUR"','length': 10,'name': 'LONGUEUR','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 10,'name': 'LARGEUR','precision': 2,'type': 6},{'expression': '"PROF_HAUT"','length': 10,'name': 'PROF_HAUT','precision': 2,'type': 6},{'expression': '"SECTEUR"','length': 254,'name': 'SECTEUR','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"MODELE"','length': 254,'name': 'MODELE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"REMPLA_APP"','length': 3,'name': 'REMPLA_APP','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"IDPARENT"','length': 252,'name': 'IDPARENT','precision': 0,'type': 10},{'expression': '"COM_SST"','length': 150,'name': 'COM_SST','precision': 0,'type': 10},{'expression': '"ETAT_POTEA"','length': 50,'name': 'ETAT_POTEA','precision': 0,'type': 10}]
                    supportrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"LG_REELLE"','length': 23,'name': 'LG_REELLE','precision': 2,'type': 6},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"AVAL"','length': 50,'name': 'AVAL','precision': 0,'type': 10},{'expression': '"INSEE"','length': 10,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"STRUCTURE"','length': 50,'name': 'STRUCTURE','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"COMPO"','length': 45,'name': 'COMPO','precision': 0,'type': 10},{'expression': '"DISPONIBLE"','length': 3,'name': 'DISPONIBLE','precision': 0,'type': 10},{'expression': '"UTILISATIO"','length': 2,'name': 'UTILISATIO','precision': 0,'type': 10},{'expression': '"CASSE_BLOC"','length': 3,'name': 'CASSE_BLOC','precision': 0,'type': 10},{'expression': '"REF_FICHE"','length': 50,'name': 'REF_FICHE','precision': 0,'type': 10},{'expression': '"MODE_POSE"','length': 252,'name': 'MODE_POSE','precision': 0,'type': 10},{'expression': '"LARGEUR"','length': 200,'name': 'LARGEUR','precision': 0,'type': 10},{'expression': '"HAUTEUR"','length': 200,'name': 'HAUTEUR','precision': 0,'type': 10},{'expression': '"ETAT"','length': 100,'name': 'ETAT','precision': 0,'type': 10}]
                    dblrefac = None
                    dblcomplementrefac = None
                    zapborefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 9,'name': 'NB_PRISES','precision': 0,'type': 2},{'expression': '"COMMENTAIR"','length': 50,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"ETAT"','length': 100,'name': 'ETAT','precision': 0,'type': 10}]
                    zacablerefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"COMMENTAIR"','length': 80,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"ETAT"','length': 100,'name': 'ETAT','precision': 0,'type': 10}]
                    zasrorefac = [{'expression': '"REF_SRO"','length': 15,'name': 'REF_SRO','precision': 0,'type': 10},{'expression': '"REF_NRO"','length': 10,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 10,'name': 'NB_PRISE','precision': 0,'type': 4},{'expression': '"EPCI"','length': 70,'name': 'EPCI','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 10,'name': 'PLANNING','precision': 0,'type': 4},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                    zanrorefac = [{'expression': '"REF_NRO"','length': 252,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 252,'name': 'NB_PRISE','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 252,'name': 'PLANNING','precision': 0,'type': 10},{'expression': '"SST"','length': 252,'name': 'SST','precision': 0,'type': 10},{'expression': '"COM_SST"','length': 252,'name': 'COM_SST','precision': 0,'type': 10}]
                    
                if departement == '89':
                    adductionrefac = [{'expression': '"ID"','length': 5,'name': 'ID','precision': 0,'type': 2},{'expression': '"TYPE_STRUC"','length': 45,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 4,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"LG"','length': 4,'name': 'LG','precision': 0,'type': 2},{'expression': '"COMMENT"','length': 100,'name': 'COMMENT','precision': 0,'type': 10}]
                    boiterefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 254,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 50,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 254,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"DIMENSION"','length': 254,'name': 'DIMENSION','precision': 0,'type': 10},{'expression': '"INTERCO"','length': 50,'name': 'INTERCO','precision': 0,'type': 10},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"NBEPISSURE"','length': 10,'name': 'NBEPISSURE','precision': 0,'type': 4},{'expression': '"NBABONNES"','length': 10,'name': 'NBABONNES','precision': 0,'type': 4},{'expression': '"FA_FS"','length': 10,'name': 'FA_FS','precision': 0,'type': 4},{'expression': '"NBFUTILE"','length': 10,'name': 'NBFUTILE','precision': 0,'type': 4},{'expression': '"SUPPORT"','length': 50,'name': 'SUPPORT','precision': 0,'type': 10},{'expression': '"FONCTION"','length': 10,'name': 'FONCTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"ID_PARENT"','length': 254,'name': 'ID_PARENT','precision': 0,'type': 10},{'expression': '"FTTH"','length': 10,'name': 'FTTH','precision': 0,'type': 4},{'expression': '"FTTE"','length': 10,'name': 'FTTE','precision': 0,'type': 4},{'expression': '"FAFSH"','length': 10,'name': 'FAFSH','precision': 0,'type': 4},{'expression': '"FAFSE"','length': 10,'name': 'FAFSE','precision': 0,'type': 4},{'expression': '"NBFUH"','length': 10,'name': 'NBFUH','precision': 0,'type': 4},{'expression': '"NBFUE"','length': 10,'name': 'NBFUE','precision': 0,'type': 4},{'expression': '"TYPE_EQUIP"','length': 200,'name': 'TYPE_EQUIP','precision': 0,'type': 10},{'expression': '"VOLUME"','length': 200,'name': 'VOLUME','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 200,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"HAUTEUR"','length': 200,'name': 'HAUTEUR','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 200,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    siterefac = [{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONCT"','length': 254,'name': 'TYPE_FONCT','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"TYPERACC"','length': 50,'name': 'TYPERACC','precision': 0,'type': 10},{'expression': '"HEXACLE"','length': 254,'name': 'HEXACLE','precision': 0,'type': 10},{'expression': '"NBPRISES"','length': 10,'name': 'NBPRISES','precision': 0,'type': 4},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"INSEE"','length': 5,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"ST_CODE"','length': 14,'name': 'ST_CODE','precision': 0,'type': 10},{'expression': '"DATE_POSE"','length': 10,'name': 'DATE_POSE','precision': 0,'type': 10}]
                    cablerefac = [{'expression': '"NOM"','length': 24,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 24,'name': 'CODE','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 50,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 20,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 20,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 50,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 50,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"ETAT"','length': 38,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"FABRICANT"','length': 20,'name': 'FABRICANT','precision': 0,'type': 10},{'expression': '"REFERENCE"','length': 20,'name': 'REFERENCE','precision': 0,'type': 10},{'expression': '"LGR_REELLE"','length': 10,'name': 'LGR_REELLE','precision': 2,'type': 6},{'expression': '"LGR_CARTO"','length': 10,'name': 'LGR_CARTO','precision': 2,'type': 6},{'expression': '"DIAMETRE"','length': 10,'name': 'DIAMETRE','precision': 2,'type': 6},{'expression': '"TYPEFIBRE"','length': 50,'name': 'TYPEFIBRE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 20,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"CAPACITE"','length': 3,'name': 'CAPACITE','precision': 0,'type': 2},{'expression': '"ORIGINE"','length': 50,'name': 'ORIGINE','precision': 0,'type': 10},{'expression': '"EXTREMITE"','length': 50,'name': 'EXTREMITE','precision': 0,'type': 10},{'expression': '"SECTION"','length': 10,'name': 'SECTION','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2},{'expression': '"FUH"','length': 5,'name': 'FUH','precision': 0,'type': 2},{'expression': '"FUE"','length': 5,'name': 'FUE','precision': 0,'type': 2},{'expression': '"EL"','length': 5,'name': 'EL','precision': 0,'type': 2},{'expression': '"DATE_MCO"','length': 25,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    ptrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_FONC"','length': 254,'name': 'TYPE_FONC','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"ETAT"','length': 254,'name': 'ETAT','precision': 0,'type': 10},{'expression': '"EMPRISE"','length': 254,'name': 'EMPRISE','precision': 0,'type': 10},{'expression': '"LONGUEUR"','length': 10,'name': 'LONGUEUR','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 10,'name': 'LARGEUR','precision': 2,'type': 6},{'expression': '"PROF_HAUT"','length': 10,'name': 'PROF_HAUT','precision': 2,'type': 6},{'expression': '"SECTEUR"','length': 254,'name': 'SECTEUR','precision': 0,'type': 10},{'expression': '"RATTACH"','length': 50,'name': 'RATTACH','precision': 0,'type': 10},{'expression': '"MODELE"','length': 254,'name': 'MODELE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"IDPARENT"','length': 15,'name': 'IDPARENT','precision': 0,'type': 10},{'expression': '"REMPLA_APP"','length': 3,'name': 'REMPLA_APP','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 20,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    supportrefac = [{'expression': '"NOM"','length': 254,'name': 'NOM','precision': 0,'type': 10},{'expression': '"CODE"','length': 254,'name': 'CODE','precision': 0,'type': 10},{'expression': '"PROPRIETAI"','length': 254,'name': 'PROPRIETAI','precision': 0,'type': 10},{'expression': '"GESTIONNAI"','length': 254,'name': 'GESTIONNAI','precision': 0,'type': 10},{'expression': '"TYPE_STRUC"','length': 254,'name': 'TYPE_STRUC','precision': 0,'type': 10},{'expression': '"LG_REELLE"','length': 23,'name': 'LG_REELLE','precision': 2,'type': 6},{'expression': '"LARGEUR"','length': 23,'name': 'LARGEUR','precision': 0,'type': 6},{'expression': '"HAUTEUR"','length': 23,'name': 'HAUTEUR','precision': 0,'type': 6},{'expression': '"AMONT"','length': 50,'name': 'AMONT','precision': 0,'type': 10},{'expression': '"AVAL"','length': 50,'name': 'AVAL','precision': 0,'type': 10},{'expression': '"INSEE"','length': 10,'name': 'INSEE','precision': 0,'type': 10},{'expression': '"COMMENT"','length': 254,'name': 'COMMENT','precision': 0,'type': 10},{'expression': '"STRUCTURE"','length': 50,'name': 'STRUCTURE','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 10,'name': 'ISOLE','precision': 0,'type': 4},{'expression': '"COMPO"','length': 45,'name': 'COMPO','precision': 0,'type': 10},{'expression': '"DISPONIBLE"','length': 3,'name': 'DISPONIBLE','precision': 0,'type': 10},{'expression': '"UTILISATIO"','length': 2,'name': 'UTILISATIO','precision': 0,'type': 10},{'expression': '"CASSE_BLOC"','length': 3,'name': 'CASSE_BLOC','precision': 0,'type': 10},{'expression': '"REF_FICHE"','length': 50,'name': 'REF_FICHE','precision': 0,'type': 10},{'expression': '"MODE_POSE"','length': 2,'name': 'MODE_POSE','precision': 0,'type': 10},{'expression': '"DATE_MCO"','length': 20,'name': 'DATE_MCO','precision': 0,'type': 10}]
                    dblrefac = None
                    dblcomplementrefac = None
                    zapborefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 9,'name': 'NB_PRISES','precision': 0,'type': 2},{'expression': '"COMMENTAIR"','length': 50,'name': 'COMMENTAIR','precision': 0,'type': 10},{'expression': '"ISOLE"','length': 1,'name': 'ISOLE','precision': 0,'type': 2}]
                    zacablerefac = [{'expression': '"NOM"','length': 80,'name': 'NOM','precision': 0,'type': 10},{'expression': '"NB_PRISES"','length': 10,'name': 'NB_PRISES','precision': 0,'type': 4},{'expression': '"COMMENTAIR"','length': 80,'name': 'COMMENTAIR','precision': 0,'type': 10}]
                    zasrorefac = [{'expression': '"REF_SRO"','length': 10,'name': 'REF_SRO','precision': 0,'type': 10},{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"EPCI"','length': 70,'name': 'EPCI','precision': 0,'type': 10},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                    zanrorefac = [{'expression': '"REF_NRO"','length': 6,'name': 'REF_NRO','precision': 0,'type': 10},{'expression': '"NB_PRISE"','length': 5,'name': 'NB_PRISE','precision': 0,'type': 2},{'expression': '"PLANNING"','length': 1,'name': 'PLANNING','precision': 0,'type': 2},{'expression': '"SST"','length': 10,'name': 'SST','precision': 0,'type': 10}]
                

                if 'SOUS-REPARTITEUR OPTIQUE' in typeexport:
                    output_path = folder+nomsro.replace('-','_')+"_ADDUCTION_"+version+".shp"
                    parameters = { 'FIELDS_MAPPING' : adductionrefac,
                        'INPUT' : QgsProcessingFeatureSourceDefinition(adductionlyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                        'OUTPUT' : output_path }
                    processing.run('native:refactorfields', parameters)
                
                output_path = folder+nomsro.replace('-','_')+"_BOITE_OPTIQUE_"+version+".shp"
                parameters = { 'FIELDS_MAPPING' : boiterefac,
                    'INPUT' : QgsProcessingFeatureSourceDefinition(boitelyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'OUTPUT' : output_path }
                processing.run('native:refactorfields', parameters)
                
                output_path = folder+nomsro.replace('-','_')+"_SITE_"+version+".shp"
                parameters = { 'FIELDS_MAPPING' : siterefac,
                    'INPUT' : QgsProcessingFeatureSourceDefinition(sitelyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'OUTPUT' : output_path }
                processing.run('native:refactorfields', parameters)
                
                output_path = folder+nomsro.replace('-','_')+"_CABLE_OPTIQUE_"+version+".shp"
                parameters = { 'FIELDS_MAPPING' : cablerefac,
                    'INPUT' : QgsProcessingFeatureSourceDefinition(cablelyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'OUTPUT' : output_path }
                processing.run('native:refactorfields', parameters)
                

                output_path = folder+nomsro.replace('-','_')+"_POINT_TECHNIQUE_"+version+".shp"
                parameters = { 'FIELDS_MAPPING' : ptrefac,
                    'INPUT' : QgsProcessingFeatureSourceDefinition(ptlyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'OUTPUT' : output_path }
                processing.run("native:refactorfields", parameters)
                
                output_path = folder+nomsro.replace('-','_')+"_SUPPORT_"+version+".shp"
                parameters = { 'FIELDS_MAPPING' : supportrefac,
                    'INPUT' : QgsProcessingFeatureSourceDefinition(supportlyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'OUTPUT' : output_path }
                processing.run('native:refactorfields', parameters)
                

                if 'SOUS-REPARTITEUR OPTIQUE' in typeexport:
                    if dblrefac != None:
                        output_path = folder+nomsro.replace('-','_')+"_EXE_CCE_DBL_PCE_001_"+version+".shp"
                        parameters = { 'FIELDS_MAPPING' : dblrefac,
                            'INPUT' : dbllyr,
                            'OUTPUT' : output_path }
                        processing.run('native:refactorfields', parameters)

                    if dblcomplementrefac != None:
                        if dblcomplementlyr.selectedFeatureCount() > 0:
                            output_path = folder+nomsro.replace('-','_')+"_EXE_CCE_DBL_COMPLEMENT_PCE_001_"+version+".shp"
                            parameters = { 'FIELDS_MAPPING' : dblcomplementrefac,
                                'INPUT' : QgsProcessingFeatureSourceDefinition(dblcomplementlyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                                'OUTPUT' : output_path }
                            processing.run('native:refactorfields', parameters)
                

                if 'SOUS-REPARTITEUR OPTIQUE' in typeexport:
                    output_path = folder+nomsro.replace('-','_')+"_ZAPBO_"+version+".shp"
                    parameters = { 'FIELDS_MAPPING' : zapborefac,
                        'INPUT' : QgsProcessingFeatureSourceDefinition(zapbolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                        'OUTPUT' : output_path }
                    processing.run('native:refactorfields', parameters)
                

                if 'SOUS-REPARTITEUR OPTIQUE' in typeexport:
                    output_path = folder+nomsro.replace('-','_')+"_ZACABLE_"+version+".shp"
                    parameters = { 'FIELDS_MAPPING' : zacablerefac,
                        'INPUT' : QgsProcessingFeatureSourceDefinition(zacablelyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                        'OUTPUT' : output_path }
                    processing.run('native:refactorfields', parameters)
                
                output_path = folder+nomsro.replace('-','_')+"_ZASRO_"+version+".shp"
                parameters = { 'FIELDS_MAPPING' : zasrorefac,
                    'INPUT' : QgsProcessingFeatureSourceDefinition(zasrolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'OUTPUT' : output_path }
                processing.run('native:refactorfields', parameters)
                
                output_path = folder+nomsro.replace('-','_')+"_ZANRO_"+version+".shp"
                parameters = { 'FIELDS_MAPPING' : zanrorefac,
                    'INPUT' : QgsProcessingFeatureSourceDefinition(zanrolyr.dataProvider().dataSourceUri(), selectedFeaturesOnly=True, featureLimit=-1, geometryCheck=QgsFeatureRequest.GeometryAbortOnInvalid),
                    'OUTPUT' : output_path }
                processing.run('native:refactorfields', parameters)
                

                if 'SOUS-REPARTITEUR OPTIQUE' in typeexport:
                    exportdbl = QgsVectorLayer(folder+nomsro.replace('-','_')+"_EXE_CCE_DBL_PCE_001_"+version+".shp", "exportdbl", "ogr")
                    nb_prise = 0
                    for dbl in exportdbl.getFeatures():
                        nb_prise = nb_prise+dbl["nb_prise"]
                        
                    exportzasro = QgsVectorLayer(folder+nomsro.replace('-','_')+"_ZASRO_"+version+".shp", "exportzasro", "ogr")
                    nb_prise_zasro = exportzasro.fields().indexFromName('NB_PRISE')
                    exportzasro.startEditing()
                    for zasro in exportzasro.getFeatures():
                        exportzasro.changeAttributeValue(zasro.id(), nb_prise_zasro, int(nb_prise))
                    exportzasro.commitChanges()
                    
                    exportzanro = QgsVectorLayer(folder+nomsro.replace('-','_')+"_ZANRO_"+version+".shp", "exportzanro", "ogr")
                    nb_prise_zanro = exportzanro.fields().indexFromName('NB_PRISE')
                    exportzanro.startEditing()
                    for zanro in exportzanro.getFeatures():
                        exportzanro.changeAttributeValue(zanro.id(), nb_prise_zanro, int(nb_prise))
                    exportzanro.commitChanges()
                

                

                if 'SOUS-REPARTITEUR OPTIQUE' in typeexport:
                    if dblcomplet != None:
                        QgsProject.instance().removeMapLayers([dblcomplet.id()])
                    QgsProject.instance().removeMapLayers([dbllyr.id()])
                
                QMessageBox.information(None, "Export russi", 'Dossier cr sur le bureau : '+folder)
            elif sitelyr.selectedFeatureCount()<1:
                QMessageBox.critical(None, "Erreur critique", 'Un SRO doit etre slectionn')
            else:
                QMessageBox.critical(None, "Erreur critique", 'Un seul SRO doit etre slectionn')